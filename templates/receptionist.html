{% extends "base.html" %}
{% block content %}

<!--Dashborad-->
<section class="dashboard" id="dashboard">
    <div class="container">
        <div class="dashboard-header">
            <h2 class="dashboard-title">Receptionist Dashboard</h2>
            <div>
                <span id="currentDate"></span>
            </div>
        </div>
        <div class="d-flex gap-2 flex-wrap">
            <a href="#addPatient" class="btn btn-primary">Add New Patient</a>
            <a href="#billing" class="btn btn-primary">Billing</a>
            <a href="#appointment" class="btn btn-primary">Appointment</a>
            <a href="{{url_for('home')}}" class="btn btn-primary">Logout</a>
        </div>
    </div>
</section>

<!--Adding New Patient-->
<section id="addPatient" class="section-padding">
    <div class="container">
        <div class="row text-center mb-5">
            <div class="col-lg-8 mx-auto">
                <h2 class="section-title">Add New Patient</h2>
                <p>You can add new Patients from here.</p>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="booking-form">
                    <form action="{{url_for('add_patient')}}" method="POST">
                        <div class="row">
                            <div class="col-md-6  mb-3">
                                <label for="patient name" class="form-label">Patient Name</label>
                                <input type="text" class="form-control" name="name" placeholder="Name" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="patient age" class="form-label">Age</label>
                                <input type="text" class="form-control" name="age" placeholder="Age" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="patient gender" class="form-label">Gender</label>
                                <select class="form-control" name="gender">
                                    <option value="">Select gender</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="patient phone" class="form-label">Phone</label>
                                <input type="tel" class="form-control" name="phone" placeholder="Phone Number" required>
                            </div>
                            <div class="col-12">
                                <label for="patient condition" class="form-label">Condition</label>
                                <textarea class="form-control" name="condition" rows="3"
                                    placeholder="Bried description of patient condition."></textarea>
                            </div>
                            <div class="col-12">
                                <label for=""></label>
                                <button type="submit" class="btn btn-primary form-control">Add Patient</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<!--Patients List-->
<section class="section-padding">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 mx-auto">
                <h2 class="section-title">Current Patients Queue</h2>
            </div>
            <div class="table-responsive">
                <table class="table table-bordered text-center">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Age</th>
                            <th>Gender</th>
                            <th>Phone</th>
                            <th>Condition</th>
                            <th>Token</th>
                            <th>Date Added</th>
                            <th>Edit</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for patient in patients %}
                        <tr class="text-center">
                            <td>{{ patient['id'] }}</td>
                            <td>{{ patient['name'] }}</td>
                            <td>{{ patient['age'] }}</td>
                            <td>{{ patient['gender'] }}</td>
                            <td>{{ patient['phone'] }}</td>
                            <td>{{ patient['condition'] }}</td>
                            <td>{{ patient['token'] }}</td>
                            <td>{{ patient['date_added'] }}</td>
                            <td><a href="{{ url_for('delete_patient', patient_id=patient['id']) }}" class="btn btn-primary">Delete</a></td>
                        </tr>
                        {% else %}
                        <tr>
                            <td colspan="9">No patients added yet</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    </div>
</section>

<!--Billing Section-->
<section id="billing" class="section-padding">
    <div class="container">
        <div class="row text-center mb-5">
            <div class="col-lg-8 mx-auto">
                <h2 class="section-title">Billing Section</h2>
                <p>You can assign Bills for Patients from here.</p>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="booking-form">
                    <form action="{{ url_for('generate_bill') }}" method="POST">
                        <div class="row">
                            <!-- Select Patient -->
                            <div class="col-md-6  mb-3">
                                <label class="form-label">Select Patient</label>
                                <select class="form-control" name="patient_id" required>
                                    <option value="">Select a patient</option>
                                    {% for patient in patients %}
                                    <option value="{{ patient['id'] }}">{{ patient['name'] }}</option>
                                    {% endfor %}
                                </select>
                            </div>

                            <!-- Consultation Fee -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Consultation Fee (in INR)</label>
                                <input type="number" name="consultation_fee" value="100" class="form-control" required>
                            </div>

                            <!-- Medication Fee -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Medication Fee (in INR)</label>
                                <input type="number" name="medication_fee" class="form-control">
                            </div>

                            <!-- Other Charges -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Other Charges (in INR)</label>
                                <input type="number" name="other_charges" class="form-control">
                            </div>

                            <!-- Submit -->
                            <div class="col-12 text-center">
                                <button type="submit" class="btn btn-primary">Complete Billing</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<!--Billing records-->
<section class="section-padding">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 mx-auto">
                <h2 class="section-title">Billing records</h2>
            </div>
            <div class="table-responsive">
                <table class="table table-bordered text-center">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Patient Name</th>
                            <th>Consultation</th>
                            <th>Medication</th>
                            <th>Other</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for b in billing %}
                        <tr>
                            <td>{{ b['id'] }}</td>
                            <td>{{ b['name'] }}</td>
                            <td>{{ b['consultation_fee'] }}</td>
                            <td>{{ b['medication_fee'] }}</td>
                            <td>{{ b['other_charges'] }}</td>
                            <td><strong>{{ b['total'] }}</strong></td>
                        </tr>
                        {% else %}
                        <tr>
                            <td colspan="6">No bills generated yet</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>


<!--Booking Appoitment-->
<section id="appointment" class="section-padding">
    <div class="container">
        <div class="row text-center mb-5">
            <div class="col-lg-8 mx-auto">
                <h2 class="section-title">Schedule Appointment</h2>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="booking-form">
                    <form action="{{url_for('schedule_appointment')}}" method="POST">
                        <div class="row">
                            <div class="col-md-6  mb-3">
                                <label for="appoitment patient name" class="form-label">Patient Name</label>
                                <input type="text" class="form-control" name="patient_name" placeholder="Name" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="appoitment patient age" class="form-label">Age</label>
                                <input type="text" class="form-control" name="age" placeholder="Age" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="appoitment date" class="form-label">Date</label>
                                <input type="date" class="form-control" name="date" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="appoitment time" class="form-label">Time</label>
                                <input type="time" class="form-control" name="time" required>
                            </div>
                            <div class="col-12 text-center">
                                <button type="submit" class="btn btn-primary">Schedule Appoitment</button>
                            </div>
                        </div>
                    </form>
                </div>

            </div>
        </div>
    </div>
</section>



<script>
    const navLinks = document.querySelectorAll(".nav-link")
    navLinks.forEach(link => {
        link.style.display = 'none';
    })

    const currentDate = document.getElementById('currentDate');
    currentDate.textContent = new Date().toLocaleDateString('en-US', {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });


</script>

{% endblock %}